<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>SEQ_TABLES TUTORIAL &mdash; Seq Table Documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Seq Table Documentation" href="index.html" />
    <link rel="next" title="Jumping into the source code for seqtables" href="to_the_code.html" />
    <link rel="prev" title="Documenation for the starting repository of seqtable" href="index.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="to_the_code.html" title="Jumping into the source code for seqtables"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Documenation for the starting repository of seqtable"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Seq Table Documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="seq-tables-tutorial">
<span id="jupyternotebooktutorial"></span><h1>SEQ_TABLES TUTORIAL<a class="headerlink" href="#seq-tables-tutorial" title="Permalink to this headline">¶</a></h1>
<div class="code python highlight-default"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Seq tables will take in sequences and quality scores and put them into dataframe. In addition, each sequence</span>
<span class="sd">of tables in which each row is a specific sequence and each column is a specific position within the sequence.</span>
<span class="sd">this allows useful slicing and determination of hamming distance between sequences</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">seq_tables</span>
<span class="kn">from</span> <span class="nn">plotly.offline</span> <span class="k">import</span> <span class="n">iplot</span><span class="p">,</span> <span class="n">init_notebook_mode</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">plotly</span> <span class="k">import</span> <span class="n">graph_objs</span> <span class="k">as</span> <span class="n">go</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span class="o">%</span><span class="n">load_ext</span> <span class="n">autoreload</span>
<span class="o">%</span><span class="n">autoreload</span> <span class="mi">2</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span class="n">init_notebook_mode</span><span class="p">()</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">There are multiple ways to initialize this class. Essentially it just needs a list of aligned sequences to one another.</span>
<span class="sd">If you would like to you could also past in a list of quality scores</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span class="n">seqs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;AAA&#39;</span><span class="p">,</span> <span class="s1">&#39;ACT&#39;</span><span class="p">,</span> <span class="s1">&#39;ACA&#39;</span><span class="p">]</span>
<span class="n">quals</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ZCA&#39;</span><span class="p">,</span> <span class="s1">&#39;DGJ&#39;</span><span class="p">,</span> <span class="s1">&#39;JJJ&#39;</span><span class="p">]</span>
<span class="n">sq</span> <span class="o">=</span> <span class="n">seq_tables</span><span class="o">.</span><span class="n">seqtable</span><span class="p">(</span><span class="n">seqs</span><span class="p">,</span> <span class="n">quals</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span class="c1"># This class has three important attributes</span>
<span class="c1"># 1) sq.seq_df =&gt; returns a dataframe of the original sequence and/or quality</span>
<span class="n">sq</span><span class="o">.</span><span class="n">seq_df</span>
</pre></div>
</div>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>seqs</th>
      <th>quals</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AAA</td>
      <td>ZCA</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ACT</td>
      <td>DGJ</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ACA</td>
      <td>JJJ</td>
    </tr>
  </tbody>
</table>
</div><div class="code python highlight-default"><div class="highlight"><pre><span class="c1"># 2) sq.seq_table =&gt; this represents all letters in the sequences as a table of rows/columns of ascii values</span>
<span class="n">sq</span><span class="o">.</span><span class="n">seq_table</span>
</pre></div>
</div>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>65</td>
      <td>65</td>
      <td>65</td>
    </tr>
    <tr>
      <th>1</th>
      <td>65</td>
      <td>67</td>
      <td>84</td>
    </tr>
    <tr>
      <th>2</th>
      <td>65</td>
      <td>67</td>
      <td>65</td>
    </tr>
  </tbody>
</table>
</div><div class="code python highlight-default"><div class="highlight"><pre><span class="c1"># if you would like, you could view the letters as actual letters instead of ascii</span>
<span class="n">sq</span><span class="o">.</span><span class="n">view_bases</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="n">array</span><span class="p">([[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">],</span>
       <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">],</span>
       <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">]],</span>
      <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;|S1&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span class="c1"># Now we can slice select positions</span>
<span class="n">sq</span><span class="o">.</span><span class="n">view_bases</span><span class="p">()[:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="n">array</span><span class="p">([[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">],</span>
       <span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">],</span>
       <span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">]],</span>
      <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;|S1&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span class="c1"># 3) sq.qual_table =&gt; this represents the qualitysequence as actual quality bases</span>
<span class="n">sq</span><span class="o">.</span><span class="n">qual_table</span>
</pre></div>
</div>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>57</td>
      <td>34</td>
      <td>32</td>
    </tr>
    <tr>
      <th>1</th>
      <td>35</td>
      <td>38</td>
      <td>41</td>
    </tr>
    <tr>
      <th>2</th>
      <td>41</td>
      <td>41</td>
      <td>41</td>
    </tr>
  </tbody>
</table>
</div><div class="code python highlight-default"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Now lets actualy load real data from a fastq file</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">sq</span> <span class="o">=</span> <span class="n">seq_tables</span><span class="o">.</span><span class="n">read_fastq</span><span class="p">(</span><span class="s2">&quot;test/Demo.fq&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span class="n">sq</span><span class="o">.</span><span class="n">view_bases</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="n">array</span><span class="p">([[</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">],</span>
       <span class="p">[</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span>
       <span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span>
       <span class="o">...</span><span class="p">,</span>
       <span class="p">[</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span>
       <span class="p">[</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">],</span>
       <span class="p">[</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">]],</span>
      <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;|S1&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span class="n">sq</span><span class="o">.</span><span class="n">seq_table</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="p">(</span><span class="mi">3000</span><span class="p">,</span> <span class="mi">250</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">We can get a distribution of the quality scores in the data</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">plotsmade</span><span class="p">)</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">get_quality_dist</span><span class="p">()</span>
<span class="n">dist</span>
</pre></div>
</div>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10-14</th>
      <th>...</th>
      <th>205-209</th>
      <th>210-214</th>
      <th>215-219</th>
      <th>220-224</th>
      <th>225-229</th>
      <th>230-234</th>
      <th>235-239</th>
      <th>240-244</th>
      <th>245-249</th>
      <th>250-254</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>3000.000000</td>
      <td>3000.000000</td>
      <td>3000.000000</td>
      <td>3000.000000</td>
      <td>3000.000000</td>
      <td>3000.000000</td>
      <td>3000.000000</td>
      <td>3000.000000</td>
      <td>3000.000000</td>
      <td>15000.000000</td>
      <td>...</td>
      <td>15000.000000</td>
      <td>15000.000000</td>
      <td>15000.000000</td>
      <td>15000.000000</td>
      <td>15000.000000</td>
      <td>15000.000000</td>
      <td>15000.000000</td>
      <td>15000.000000</td>
      <td>15000.000000</td>
      <td>3000.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>32.461333</td>
      <td>32.855000</td>
      <td>33.074667</td>
      <td>33.214000</td>
      <td>32.972000</td>
      <td>32.285000</td>
      <td>32.454667</td>
      <td>32.358333</td>
      <td>32.924000</td>
      <td>33.957000</td>
      <td>...</td>
      <td>32.416067</td>
      <td>32.170867</td>
      <td>31.733000</td>
      <td>31.514533</td>
      <td>30.088267</td>
      <td>29.954067</td>
      <td>30.340867</td>
      <td>30.250333</td>
      <td>30.004200</td>
      <td>22.639667</td>
    </tr>
    <tr>
      <th>std</th>
      <td>3.007134</td>
      <td>2.527338</td>
      <td>2.031042</td>
      <td>1.773486</td>
      <td>2.330313</td>
      <td>4.571879</td>
      <td>2.896678</td>
      <td>3.010695</td>
      <td>2.215821</td>
      <td>4.554324</td>
      <td>...</td>
      <td>8.113011</td>
      <td>8.209306</td>
      <td>8.263074</td>
      <td>8.380561</td>
      <td>9.213078</td>
      <td>9.250358</td>
      <td>9.030052</td>
      <td>9.235223</td>
      <td>9.219869</td>
      <td>9.778839</td>
    </tr>
    <tr>
      <th>min</th>
      <td>16.000000</td>
      <td>2.000000</td>
      <td>16.000000</td>
      <td>16.000000</td>
      <td>16.000000</td>
      <td>16.000000</td>
      <td>16.000000</td>
      <td>16.000000</td>
      <td>16.000000</td>
      <td>15.000000</td>
      <td>...</td>
      <td>12.000000</td>
      <td>2.000000</td>
      <td>2.000000</td>
      <td>2.000000</td>
      <td>12.000000</td>
      <td>2.000000</td>
      <td>2.000000</td>
      <td>12.000000</td>
      <td>12.000000</td>
      <td>12.000000</td>
    </tr>
    <tr>
      <th>10%</th>
      <td>32.000000</td>
      <td>32.000000</td>
      <td>32.000000</td>
      <td>32.000000</td>
      <td>32.000000</td>
      <td>30.000000</td>
      <td>32.000000</td>
      <td>32.000000</td>
      <td>32.000000</td>
      <td>32.000000</td>
      <td>...</td>
      <td>14.000000</td>
      <td>14.000000</td>
      <td>13.000000</td>
      <td>13.000000</td>
      <td>13.000000</td>
      <td>13.000000</td>
      <td>14.000000</td>
      <td>13.000000</td>
      <td>14.000000</td>
      <td>12.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>32.000000</td>
      <td>32.000000</td>
      <td>33.000000</td>
      <td>33.000000</td>
      <td>33.000000</td>
      <td>33.000000</td>
      <td>32.000000</td>
      <td>32.000000</td>
      <td>32.000000</td>
      <td>33.000000</td>
      <td>...</td>
      <td>32.000000</td>
      <td>32.000000</td>
      <td>31.000000</td>
      <td>30.000000</td>
      <td>26.000000</td>
      <td>24.000000</td>
      <td>25.000000</td>
      <td>25.000000</td>
      <td>24.000000</td>
      <td>14.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>33.000000</td>
      <td>33.000000</td>
      <td>33.000000</td>
      <td>33.000000</td>
      <td>33.000000</td>
      <td>33.000000</td>
      <td>33.000000</td>
      <td>33.000000</td>
      <td>33.000000</td>
      <td>34.000000</td>
      <td>...</td>
      <td>37.000000</td>
      <td>37.000000</td>
      <td>37.000000</td>
      <td>37.000000</td>
      <td>35.000000</td>
      <td>35.000000</td>
      <td>36.000000</td>
      <td>36.000000</td>
      <td>35.000000</td>
      <td>15.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>34.000000</td>
      <td>34.000000</td>
      <td>34.000000</td>
      <td>34.000000</td>
      <td>34.000000</td>
      <td>34.000000</td>
      <td>34.000000</td>
      <td>34.000000</td>
      <td>34.000000</td>
      <td>38.000000</td>
      <td>...</td>
      <td>37.000000</td>
      <td>37.000000</td>
      <td>37.000000</td>
      <td>37.000000</td>
      <td>37.000000</td>
      <td>37.000000</td>
      <td>37.000000</td>
      <td>37.000000</td>
      <td>37.000000</td>
      <td>33.000000</td>
    </tr>
    <tr>
      <th>90%</th>
      <td>34.000000</td>
      <td>34.000000</td>
      <td>34.000000</td>
      <td>35.000000</td>
      <td>34.000000</td>
      <td>35.000000</td>
      <td>34.000000</td>
      <td>34.000000</td>
      <td>34.000000</td>
      <td>38.000000</td>
      <td>...</td>
      <td>37.000000</td>
      <td>37.000000</td>
      <td>37.000000</td>
      <td>37.000000</td>
      <td>37.000000</td>
      <td>37.000000</td>
      <td>37.000000</td>
      <td>37.000000</td>
      <td>37.000000</td>
      <td>37.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>36.000000</td>
      <td>36.000000</td>
      <td>36.000000</td>
      <td>36.000000</td>
      <td>36.000000</td>
      <td>37.000000</td>
      <td>37.000000</td>
      <td>37.000000</td>
      <td>37.000000</td>
      <td>38.000000</td>
      <td>...</td>
      <td>39.000000</td>
      <td>39.000000</td>
      <td>39.000000</td>
      <td>39.000000</td>
      <td>39.000000</td>
      <td>39.000000</td>
      <td>39.000000</td>
      <td>39.000000</td>
      <td>39.000000</td>
      <td>38.000000</td>
    </tr>
  </tbody>
</table>
<p>10 rows × 57 columns</p>
</div><div class="code python highlight-default"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">The function get_quality_dist also returns plot objects that can be used by plotly</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">iplot</span><span class="p">(</span><span class="n">plotsmade</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Filter out low quality sequences</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">sq</span><span class="o">.</span><span class="n">quality_filter</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">
                                                                                                 seqs  M01012:51:000000000-A4H0H:1:1101:15861:1495 1:N...  GNCGTGACGTTGGACGAGTCCGGGGGCGGCCTCCAGACGCCCGGAG...
M01012:51:000000000-A4H0H:1:1101:16832:1547 1:N...  GGAGGAGACGATGACTTCGGTCCCGTGGCCCCATGCGTCGATACAG...
M01012:51:000000000-A4H0H:1:1101:14519:1548 1:N...  CGTGACGTTGGACGAGTCCGGGGGCGGCCTCCAGACGCCCGGAGGA...

                                                                                                quals
M01012:51:000000000-A4H0H:1:1101:15861:1495 1:N...  B#&gt;AABCCCCCCGGGGGGGGGGGGGGEGGGGGHHHHHGGGGGGGGG...
M01012:51:000000000-A4H0H:1:1101:16832:1547 1:N...  A&#64;ABB&#64;A&gt;AADAGGGGGGGGFGGHGH2EEBGEEHHHGGGGGFGGGH...
M01012:51:000000000-A4H0H:1:1101:14519:1548 1:N...  AAAAAA&gt;&gt;&gt;&gt;&gt;1BE1AEBFFGG0EEGCGEFCC&gt;FGGGG/EEEEGGG...

[2963 rows x 2 columns]
</pre>
<div class="code python highlight-default"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Convert any low quality bases to N</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">sq</span><span class="o">.</span><span class="n">convert_low_bases_to_null</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">
                                                                                                 seqs  M01012:51:000000000-A4H0H:1:1101:15861:1495 1:N...  GNCGTGACGTTGGACGAGTCCGGGGGCGGCCTCCAGACGCCCGGAG...
M01012:51:000000000-A4H0H:1:1101:16832:1547 1:N...  GGAGGAGACGATGACTTCGGTCCCGTNGCCCCATGCGTCGATACAG...
M01012:51:000000000-A4H0H:1:1101:14519:1548 1:N...  CGTGACGTTGGNCGNGTCCGGGNGCGGCCTCCAGACGCNCGGAGGA...

                                                                                                quals
M01012:51:000000000-A4H0H:1:1101:15861:1495 1:N...  B#&gt;AABCCCCCCGGGGGGGGGGGGGGEGGGGGHHHHHGGGGGGGGG...
M01012:51:000000000-A4H0H:1:1101:16832:1547 1:N...  A&#64;ABB&#64;A&gt;AADAGGGGGGGGFGGHGH2EEBGEEHHHGGGGGFGGGH...
M01012:51:000000000-A4H0H:1:1101:14519:1548 1:N...  AAAAAA&gt;&gt;&gt;&gt;&gt;1BE1AEBFFGG0EEGCGEFCC&gt;FGGGG/EEEEGGG...

[3000 rows x 2 columns]
</pre>
<div class="code python highlight-default"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Get the hamming distances of all sequences to the first sequence</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">sq</span><span class="o">.</span><span class="n">hamming_distance</span><span class="p">(</span><span class="n">sq</span><span class="o">.</span><span class="n">seq_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;seqs&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="n">M01012</span><span class="p">:</span><span class="mi">51</span><span class="p">:</span><span class="mi">000000000</span><span class="o">-</span><span class="n">A4H0H</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">1101</span><span class="p">:</span><span class="mi">15861</span><span class="p">:</span><span class="mi">1495</span> <span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="o">|</span> <span class="o">&lt;</span><span class="p">{</span><span class="s2">&quot;SEQ_ID&quot;</span><span class="p">:</span> <span class="s2">&quot;552c2da19eb63635e1c950f1::552c261b9eb6363a487b62c9&quot;</span><span class="p">}</span>      <span class="mi">0</span>
<span class="n">M01012</span><span class="p">:</span><span class="mi">51</span><span class="p">:</span><span class="mi">000000000</span><span class="o">-</span><span class="n">A4H0H</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">1101</span><span class="p">:</span><span class="mi">16832</span><span class="p">:</span><span class="mi">1547</span> <span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="o">|</span> <span class="o">&lt;</span><span class="p">{</span><span class="s2">&quot;SEQ_ID&quot;</span><span class="p">:</span> <span class="s2">&quot;552c2da19eb63635e1c950f2::552c261b9eb6363a487b62c9&quot;</span><span class="p">}</span>    <span class="mi">189</span>
<span class="n">M01012</span><span class="p">:</span><span class="mi">51</span><span class="p">:</span><span class="mi">000000000</span><span class="o">-</span><span class="n">A4H0H</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">1101</span><span class="p">:</span><span class="mi">14519</span><span class="p">:</span><span class="mi">1548</span> <span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="o">|</span> <span class="o">&lt;</span><span class="p">{</span><span class="s2">&quot;SEQ_ID&quot;</span><span class="p">:</span> <span class="s2">&quot;552c2da19eb63635e1c950f3::552c261b9eb6363a487b62c9&quot;</span><span class="p">}</span>    <span class="mi">190</span>
<span class="n">M01012</span><span class="p">:</span><span class="mi">51</span><span class="p">:</span><span class="mi">000000000</span><span class="o">-</span><span class="n">A4H0H</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">1101</span><span class="p">:</span><span class="mi">14011</span><span class="p">:</span><span class="mi">1558</span> <span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="o">|</span> <span class="o">&lt;</span><span class="p">{</span><span class="s2">&quot;SEQ_ID&quot;</span><span class="p">:</span> <span class="s2">&quot;552c2da19eb63635e1c950f4::552c261b9eb6363a487b62c9&quot;</span><span class="p">}</span>     <span class="mi">43</span>
<span class="n">M01012</span><span class="p">:</span><span class="mi">51</span><span class="p">:</span><span class="mi">000000000</span><span class="o">-</span><span class="n">A4H0H</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">1101</span><span class="p">:</span><span class="mi">16697</span><span class="p">:</span><span class="mi">1561</span> <span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="o">|</span> <span class="o">&lt;</span><span class="p">{</span><span class="s2">&quot;SEQ_ID&quot;</span><span class="p">:</span> <span class="s2">&quot;552c2da19eb63635e1c950f5::552c261b9eb6363a487b62c9&quot;</span><span class="p">}</span>    <span class="mi">197</span>
<span class="n">M01012</span><span class="p">:</span><span class="mi">51</span><span class="p">:</span><span class="mi">000000000</span><span class="o">-</span><span class="n">A4H0H</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">1101</span><span class="p">:</span><span class="mi">14388</span><span class="p">:</span><span class="mi">1594</span> <span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="o">|</span> <span class="o">&lt;</span><span class="p">{</span><span class="s2">&quot;SEQ_ID&quot;</span><span class="p">:</span> <span class="s2">&quot;552c2da19eb63635e1c950f6::552c261b9eb6363a487b62c9&quot;</span><span class="p">}</span>    <span class="mi">189</span>
<span class="n">M01012</span><span class="p">:</span><span class="mi">51</span><span class="p">:</span><span class="mi">000000000</span><span class="o">-</span><span class="n">A4H0H</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">1101</span><span class="p">:</span><span class="mi">16245</span><span class="p">:</span><span class="mi">1601</span> <span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="o">|</span> <span class="o">&lt;</span><span class="p">{</span><span class="s2">&quot;SEQ_ID&quot;</span><span class="p">:</span> <span class="s2">&quot;552c2da19eb63635e1c950f7::552c261b9eb6363a487b62c9&quot;</span><span class="p">}</span>    <span class="mi">196</span>
<span class="n">M01012</span><span class="p">:</span><span class="mi">51</span><span class="p">:</span><span class="mi">000000000</span><span class="o">-</span><span class="n">A4H0H</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">1101</span><span class="p">:</span><span class="mi">14065</span><span class="p">:</span><span class="mi">1607</span> <span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="o">|</span> <span class="o">&lt;</span><span class="p">{</span><span class="s2">&quot;SEQ_ID&quot;</span><span class="p">:</span> <span class="s2">&quot;552c2da19eb63635e1c950f8::552c261b9eb6363a487b62c9&quot;</span><span class="p">}</span>     <span class="mi">50</span>
<span class="n">M01012</span><span class="p">:</span><span class="mi">51</span><span class="p">:</span><span class="mi">000000000</span><span class="o">-</span><span class="n">A4H0H</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">1101</span><span class="p">:</span><span class="mi">15481</span><span class="p">:</span><span class="mi">1612</span> <span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="o">|</span> <span class="o">&lt;</span><span class="p">{</span><span class="s2">&quot;SEQ_ID&quot;</span><span class="p">:</span> <span class="s2">&quot;552c2da19eb63635e1c950f9::552c261b9eb6363a487b62c9&quot;</span><span class="p">}</span>     <span class="mi">92</span>
<span class="n">M01012</span><span class="p">:</span><span class="mi">51</span><span class="p">:</span><span class="mi">000000000</span><span class="o">-</span><span class="n">A4H0H</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">1101</span><span class="p">:</span><span class="mi">13999</span><span class="p">:</span><span class="mi">1617</span> <span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="o">|</span> <span class="o">&lt;</span><span class="p">{</span><span class="s2">&quot;SEQ_ID&quot;</span><span class="p">:</span> <span class="s2">&quot;552c2da19eb63635e1c950fa::552c261b9eb6363a487b62c9&quot;</span><span class="p">}</span>     <span class="mi">91</span>
<span class="n">M01012</span><span class="p">:</span><span class="mi">51</span><span class="p">:</span><span class="mi">000000000</span><span class="o">-</span><span class="n">A4H0H</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">1101</span><span class="p">:</span><span class="mi">14577</span><span class="p">:</span><span class="mi">1618</span> <span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="o">|</span> <span class="o">&lt;</span><span class="p">{</span><span class="s2">&quot;SEQ_ID&quot;</span><span class="p">:</span> <span class="s2">&quot;552c2da19eb63635e1c950fb::552c261b9eb6363a487b62c9&quot;</span><span class="p">}</span>    <span class="mi">103</span>
<span class="n">M01012</span><span class="p">:</span><span class="mi">51</span><span class="p">:</span><span class="mi">000000000</span><span class="o">-</span><span class="n">A4H0H</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">1101</span><span class="p">:</span><span class="mi">16257</span><span class="p">:</span><span class="mi">1622</span> <span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="o">|</span> <span class="o">&lt;</span><span class="p">{</span><span class="s2">&quot;SEQ_ID&quot;</span><span class="p">:</span> <span class="s2">&quot;552c2da19eb63635e1c950fc::552c261b9eb6363a487b62c9&quot;</span><span class="p">}</span>    <span class="mi">197</span>
<span class="n">M01012</span><span class="p">:</span><span class="mi">51</span><span class="p">:</span><span class="mi">000000000</span><span class="o">-</span><span class="n">A4H0H</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">1101</span><span class="p">:</span><span class="mi">16266</span><span class="p">:</span><span class="mi">1647</span> <span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="o">|</span> <span class="o">&lt;</span><span class="p">{</span><span class="s2">&quot;SEQ_ID&quot;</span><span class="p">:</span> <span class="s2">&quot;552c2da19eb63635e1c950fd::552c261b9eb6363a487b62c9&quot;</span><span class="p">}</span>    <span class="mi">194</span>
<span class="n">M01012</span><span class="p">:</span><span class="mi">51</span><span class="p">:</span><span class="mi">000000000</span><span class="o">-</span><span class="n">A4H0H</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">1101</span><span class="p">:</span><span class="mi">16222</span><span class="p">:</span><span class="mi">1647</span> <span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="o">|</span> <span class="o">&lt;</span><span class="p">{</span><span class="s2">&quot;SEQ_ID&quot;</span><span class="p">:</span> <span class="s2">&quot;552c2da19eb63635e1c950fe::552c261b9eb6363a487b62c9&quot;</span><span class="p">}</span>    <span class="mi">194</span>
<span class="n">M01012</span><span class="p">:</span><span class="mi">51</span><span class="p">:</span><span class="mi">000000000</span><span class="o">-</span><span class="n">A4H0H</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">1101</span><span class="p">:</span><span class="mi">15672</span><span class="p">:</span><span class="mi">1648</span> <span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="o">|</span> <span class="o">&lt;</span><span class="p">{</span><span class="s2">&quot;SEQ_ID&quot;</span><span class="p">:</span> <span class="s2">&quot;552c2da19eb63635e1c950ff::552c261b9eb6363a487b62c9&quot;</span><span class="p">}</span>     <span class="mi">43</span>
<span class="n">M01012</span><span class="p">:</span><span class="mi">51</span><span class="p">:</span><span class="mi">000000000</span><span class="o">-</span><span class="n">A4H0H</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">1101</span><span class="p">:</span><span class="mi">16537</span><span class="p">:</span><span class="mi">1664</span> <span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="o">|</span> <span class="o">&lt;</span><span class="p">{</span><span class="s2">&quot;SEQ_ID&quot;</span><span class="p">:</span> <span class="s2">&quot;552c2da19eb63635e1c95100::552c261b9eb6363a487b62c9&quot;</span><span class="p">}</span>     <span class="mi">47</span>
<span class="n">M01012</span><span class="p">:</span><span class="mi">51</span><span class="p">:</span><span class="mi">000000000</span><span class="o">-</span><span class="n">A4H0H</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">1101</span><span class="p">:</span><span class="mi">16542</span><span class="p">:</span><span class="mi">1690</span> <span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="o">|</span> <span class="o">&lt;</span><span class="p">{</span><span class="s2">&quot;SEQ_ID&quot;</span><span class="p">:</span> <span class="s2">&quot;552c2da19eb63635e1c95101::552c261b9eb6363a487b62c9&quot;</span><span class="p">}</span>    <span class="mi">194</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Or we determine the error rate at each position</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">compare_to_reference</span><span class="p">(</span><span class="n">sq</span><span class="o">.</span><span class="n">seq_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;seqs&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="n">sq</span><span class="o">.</span><span class="n">seq_table</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">iplot</span><span class="p">([</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">error</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">error</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">)])</span>
</pre></div>
</div>
<div id="dff6e7c3-4f5c-4f44-9a9f-acba040ed686" style="height: 525; width: 100%;" class="plotly-graph-div"></div><script type="text/javascript">require(["plotly"], function(Plotly) {window.PLOTLYENV=window.PLOTLYENV || {};window.PLOTLYENV.BASE_URL="https://plot.ly";Plotly.newPlot("dff6e7c3-4f5c-4f44-9a9f-acba040ed686", [{"y": [0.9393333333333334, 0.0013333333333333333, 0.5096666666666667, 0.934, 0.508, 0.5173333333333333, 0.5206666666666667, 0.5126666666666667, 0.5256666666666666, 0.511, 0.5113333333333333, 0.514, 0.9183333333333333, 0.9126666666666666, 0.9166666666666666, 0.515, 0.5093333333333333, 0.5116666666666667, 0.5053333333333333, 0.516, 0.507, 0.524, 0.515, 0.5196666666666667, 0.9206666666666666, 0.5153333333333333, 0.5146666666666667, 0.924, 0.5196666666666667, 0.9253333333333333, 0.9346666666666666, 0.5103333333333333, 0.523, 0.524, 0.528, 0.5033333333333333, 0.517, 0.5096666666666667, 0.5056666666666667, 0.5173333333333333, 0.51, 0.5316666666666666, 0.6553333333333333, 0.5636666666666666, 0.5896666666666667, 0.5543333333333333, 0.5673333333333334, 0.5416666666666666, 0.4553333333333333, 0.48133333333333334, 0.526, 0.5146666666666667, 0.6536666666666666, 0.658, 0.81, 0.5736666666666667, 0.614, 0.5783333333333334, 0.6016666666666667, 0.667, 0.523, 0.0003333333333333333, 0.6703333333333333, 0.5196666666666667, 0.5836666666666667, 0.641, 0.8446666666666667, 0.5486666666666666, 0.536, 0.564, 0.633, 0.6773333333333333, 0.5466666666666666, 0.6643333333333333, 0.6576666666666666, 0.0003333333333333333, 0.0003333333333333333, 0.5116666666666667, 0.5836666666666667, 0.6246666666666667, 0.639, 0.49733333333333335, 0.5276666666666666, 0.6383333333333333, 0.5296666666666666, 0.6343333333333333, 0.624, 0.5626666666666666, 0.5756666666666667, 0.48533333333333334, 0.4706666666666667, 0.5233333333333333, 0.49366666666666664, 0.411, 0.42533333333333334, 0.384, 0.06266666666666666, 0.23433333333333334, 0.5996666666666667, 0.5043333333333333, 0.6686666666666666, 0.49533333333333335, 0.21066666666666667, 0.22766666666666666, 0.13566666666666666, 0.5053333333333333, 0.652, 0.5253333333333333, 0.6473333333333333, 0.0003333333333333333, 0.537, 0.634, 0.622, 0.44066666666666665, 0.632, 0.5993333333333334, 0.606, 0.7626666666666667, 0.5226666666666666, 0.56, 0.6666666666666666, 0.5573333333333333, 0.5513333333333333, 0.6566666666666666, 0.515, 0.498, 0.5236666666666666, 0.6816666666666666, 0.721, 0.5906666666666667, 0.5133333333333333, 0.7036666666666667, 0.0003333333333333333, 0.5946666666666667, 0.11533333333333333, 0.5793333333333334, 0.0003333333333333333, 0.25233333333333335, 0.5793333333333334, 0.31866666666666665, 0.0003333333333333333, 0.593, 0.6046666666666667, 0.5566666666666666, 0.6246666666666667, 0.654, 0.4026666666666667, 0.11866666666666667, 0.239, 0.0006666666666666666, 0.49833333333333335, 0.0006666666666666666, 0.638, 0.095, 0.3406666666666667, 0.325, 0.37166666666666665, 0.27, 0.11033333333333334, 0.49766666666666665, 0.301, 0.6803333333333333, 0.7003333333333334, 0.6266666666666667, 0.647, 0.3943333333333333, 0.6026666666666667, 0.5843333333333334, 0.30033333333333334, 0.43833333333333335, 0.46266666666666667, 0.4786666666666667, 0.5553333333333333, 0.0006666666666666666, 0.23266666666666666, 0.3233333333333333, 0.21233333333333335, 0.4076666666666667, 0.0006666666666666666, 0.57, 0.513, 0.242, 0.49066666666666664, 0.38366666666666666, 0.5493333333333333, 0.5276666666666666, 0.5466666666666666, 0.5466666666666666, 0.539, 0.5423333333333333, 0.48633333333333334, 0.0003333333333333333, 0.39466666666666667, 0.0003333333333333333, 0.466, 0.546, 0.5946666666666667, 0.5353333333333333, 0.495, 0.5866666666666667, 0.5053333333333333, 0.532, 0.5923333333333334, 0.5943333333333334, 0.6166666666666667, 0.6386666666666667, 0.6433333333333333, 0.655, 0.4876666666666667, 0.0006666666666666666, 0.411, 0.6013333333333334, 0.43133333333333335, 0.6256666666666667, 0.454, 0.44633333333333336, 0.5, 0.5013333333333333, 0.0006666666666666666, 0.0003333333333333333, 0.5286666666666666, 0.0006666666666666666, 0.001, 0.47733333333333333, 0.44333333333333336, 0.43633333333333335, 0.513, 0.445, 0.553, 0.46166666666666667, 0.001, 0.515, 0.4723333333333333, 0.0003333333333333333, 0.0006666666666666666, 0.4736666666666667, 0.5116666666666667, 0.4226666666666667, 0.43133333333333335, 0.5506666666666666, 0.6733333333333333, 0.514, 0.5833333333333334, 0.6886666666666666, 0.44666666666666666, 0.5563333333333333, 0.6396666666666667, 0.508, 0.5516666666666666, 0.417], "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249], "type": "scatter", "mode": "markers"}], {}, {"linkText": "Export to plot.ly", "showLink": true})});</script><div class="code python highlight-default"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Lets say you want to not count specific bases or residues as mismatches</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">sq</span><span class="o">.</span><span class="n">compare_to_reference</span><span class="p">(</span><span class="n">sq</span><span class="o">.</span><span class="n">seq_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;seqs&#39;</span><span class="p">],</span> <span class="n">ignore_characters</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="n">sq</span><span class="o">.</span><span class="n">seq_table</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="mi">0</span>      <span class="mf">0.939333</span>
<span class="mi">1</span>      <span class="mf">1.000000</span>
<span class="mi">2</span>      <span class="mf">0.509667</span>
<span class="mi">3</span>      <span class="mf">0.934000</span>
<span class="mi">4</span>      <span class="mf">0.508000</span>
<span class="mi">5</span>      <span class="mf">0.517333</span>
<span class="mi">6</span>      <span class="mf">0.520667</span>
<span class="mi">7</span>      <span class="mf">0.512667</span>
<span class="mi">8</span>      <span class="mf">0.525667</span>
<span class="mi">9</span>      <span class="mf">0.511000</span>
<span class="mi">10</span>     <span class="mf">0.511333</span>
<span class="mi">11</span>     <span class="mf">0.514000</span>
<span class="mi">12</span>     <span class="mf">0.918333</span>
<span class="mi">13</span>     <span class="mf">0.912667</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Lets say you are only interested in looking at sections/regions of a sequence</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">sq</span><span class="o">.</span><span class="n">slice_sequences</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;sliced&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sliced</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>M01012:51:000000000-A4H0H:1:1101:15861:1495 1:N:0:10| &lt;{"SEQ_ID": "552c2da19eb63635e1c950f1::552c261b9eb6363a487b62c9"}</th>
      <td>CTC</td>
    </tr>
    <tr>
      <th>M01012:51:000000000-A4H0H:1:1101:16832:1547 1:N:0:10| &lt;{"SEQ_ID": "552c2da19eb63635e1c950f2::552c261b9eb6363a487b62c9"}</th>
      <td>AGG</td>
    </tr>
    <tr>
      <th>M01012:51:000000000-A4H0H:1:1101:14519:1548 1:N:0:10| &lt;{"SEQ_ID": "552c2da19eb63635e1c950f3::552c261b9eb6363a487b62c9"}</th>
      <td>TGG</td>
    </tr>
  </tbody>
</table>
<p>3000 rows × 1 columns</p>
</div><div class="code python highlight-default"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Determine the distribution of letters at each postion</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">dist</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">get_seq_dist</span><span class="p">()</span>
<span class="n">dist</span>
</pre></div>
</div>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>...</th>
      <th>241</th>
      <th>242</th>
      <th>243</th>
      <th>244</th>
      <th>245</th>
      <th>246</th>
      <th>247</th>
      <th>248</th>
      <th>249</th>
      <th>250</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>56.0</td>
      <td>101</td>
      <td>1313.0</td>
      <td>57.0</td>
      <td>107.0</td>
      <td>1293.0</td>
      <td>1562.0</td>
      <td>1327.0</td>
      <td>57.0</td>
      <td>94.0</td>
      <td>...</td>
      <td>363.0</td>
      <td>559.0</td>
      <td>237.0</td>
      <td>238.0</td>
      <td>1340.0</td>
      <td>199.0</td>
      <td>310.0</td>
      <td>546.0</td>
      <td>183.0</td>
      <td>1251.0</td>
    </tr>
    <tr>
      <th>C</th>
      <td>71.0</td>
      <td>1520</td>
      <td>1529.0</td>
      <td>84.0</td>
      <td>44.0</td>
      <td>72.0</td>
      <td>55.0</td>
      <td>1538.0</td>
      <td>1289.0</td>
      <td>59.0</td>
      <td>...</td>
      <td>2020.0</td>
      <td>540.0</td>
      <td>700.0</td>
      <td>2066.0</td>
      <td>619.0</td>
      <td>789.0</td>
      <td>1919.0</td>
      <td>504.0</td>
      <td>823.0</td>
      <td>863.0</td>
    </tr>
    <tr>
      <th>G</th>
      <td>2818.0</td>
      <td>1317</td>
      <td>68.0</td>
      <td>2802.0</td>
      <td>1325.0</td>
      <td>1552.0</td>
      <td>1319.0</td>
      <td>71.0</td>
      <td>1577.0</td>
      <td>1314.0</td>
      <td>...</td>
      <td>410.0</td>
      <td>359.0</td>
      <td>1750.0</td>
      <td>460.0</td>
      <td>309.0</td>
      <td>1669.0</td>
      <td>539.0</td>
      <td>426.0</td>
      <td>1655.0</td>
      <td>655.0</td>
    </tr>
    <tr>
      <th>N</th>
      <td>0.0</td>
      <td>4</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>T</th>
      <td>55.0</td>
      <td>58</td>
      <td>90.0</td>
      <td>57.0</td>
      <td>1524.0</td>
      <td>83.0</td>
      <td>64.0</td>
      <td>64.0</td>
      <td>77.0</td>
      <td>1533.0</td>
      <td>...</td>
      <td>207.0</td>
      <td>1542.0</td>
      <td>313.0</td>
      <td>236.0</td>
      <td>732.0</td>
      <td>343.0</td>
      <td>232.0</td>
      <td>1524.0</td>
      <td>339.0</td>
      <td>231.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 250 columns</p>
</div><div class="code python highlight-default"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">have not made functions for drawing up sequence logos yet...but maybe just plot distribution at each position</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1"># lets put a dot at specific postions of interest</span>
<span class="n">mark_these_positions</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span>
<span class="n">dist</span> <span class="o">=</span> <span class="n">dist</span><span class="o">/</span><span class="n">dist</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Bar</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">let</span><span class="p">],</span>
        <span class="n">name</span><span class="o">=</span><span class="n">let</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">let</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">]</span>
<span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">mark_these_positions</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mf">1.1</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">mark_these_positions</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">))</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">layout</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">barmode</span><span class="o">=</span><span class="s1">&#39;stack&#39;</span><span class="p">,</span> <span class="n">bargap</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="p">))</span>
<span class="n">iplot</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="n">dist_div</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">dist</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">dist</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="c1"># also plot the &quot;diversity&quot;</span>
<span class="n">iplot</span><span class="p">([</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dist</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">dist_div</span><span class="p">,</span>  <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">),</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">mark_these_positions</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mf">4.1</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">mark_these_positions</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">)])</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Return a random subsample of sequences</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">sq</span><span class="o">.</span><span class="n">subsample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">
                                                                                                 seqs  M01012:51:000000000-A4H0H:1:1101:4797:7093 1:N:...  GCCGTGACGTTGGACGAGTCCGGGGGCGGCCTCCAGACGCCCGGAG...
M01012:51:000000000-A4H0H:1:1101:16060:5388 1:N...  GCCGTGACGTTGGACGAGTCCGGGGGCGGCCTCCAGACGCCCGGAG...
M01012:51:000000000-A4H0H:1:1101:22232:5603 1:N...  GGAGGAGACGATGACTTCGGTCCCGCGGCCCCATGCGTCGATCCAA...

                                                                                                quals
M01012:51:000000000-A4H0H:1:1101:4797:7093 1:N:...  AABBBBBBBBBBGGGGGGGGGGGGGEEGGEGGHHHHHGGGGGGGGG...
M01012:51:000000000-A4H0H:1:1101:16060:5388 1:N...  ABBBADBBBBABGGGGGGGGGGCEGFGGGGGGHHCHHGGGGGFCEE...
M01012:51:000000000-A4H0H:1:1101:22232:5603 1:N...  BBBBBB&gt;AAA2AFGGGGGGGFFGHGGGGGGGGGHHHFGGEEGHGFH...
</pre>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Documenation for the starting repository of seqtable</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="to_the_code.html"
                        title="next chapter">Jumping into the source code for seqtables</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/jupyternotebooktutorial.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="to_the_code.html" title="Jumping into the source code for seqtables"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Documenation for the starting repository of seqtable"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Seq Table Documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, Constantine Chrysostomou.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4b1.
    </div>
  </body>
</html>